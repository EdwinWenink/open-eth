'use strict';var $jscomp={scope:{},getGlobal:function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global?global:a}};$jscomp.global=$jscomp.getGlobal(this);$jscomp.initSymbol=function(){$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol);$jscomp.initSymbol=function(){}};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return"jscomp_symbol_"+a+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();$jscomp.global.Symbol.iterator||($jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));$jscomp.initSymbolIterator=function(){}};
$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();if(a[$jscomp.global.Symbol.iterator])return a[$jscomp.global.Symbol.iterator]();if(!(a instanceof Array||"string"==typeof a||a instanceof String))throw new TypeError(a+" is not iterable");var b=0;return{next:function(){return b==a.length?{done:!0}:{done:!1,value:a[b++]}}}};$jscomp.arrayFromIterator=function(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c};
$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};$jscomp.arrayFromArguments=function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c]);return b};$jscomp.inherits=function(a,b){function c(){}c.prototype=b.prototype;a.prototype=new c;a.prototype.constructor=a;for(var d in b)if($jscomp.global.Object.defineProperties){var e=$jscomp.global.Object.getOwnPropertyDescriptor(b,d);$jscomp.global.Object.defineProperty(a,d,e)}else a[d]=b[d]};
$jscomp.array=$jscomp.array||{};$jscomp.array.done_=function(){return{done:!0,value:void 0}};$jscomp.array.arrayIterator_=function(a,b){a instanceof String&&(a=String(a));var c=0;$jscomp.initSymbol();$jscomp.initSymbolIterator();var d={},e=(d.next=function(){if(c<a.length){var d=c++;return{value:b(d,a[d]),done:!1}}e.next=$jscomp.array.done_;return $jscomp.array.done_()},d[Symbol.iterator]=function(){return e},d);return e};
$jscomp.array.findInternal_=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};
$jscomp.array.from=function(a,b,c){b=void 0===b?function(a){return a}:b;var d=[];$jscomp.initSymbol();$jscomp.initSymbolIterator();if(a[Symbol.iterator]){$jscomp.initSymbol();$jscomp.initSymbolIterator();a=a[Symbol.iterator]();for(var e;!(e=a.next()).done;)d.push(b.call(c,e.value))}else{e=a.length;for(var f=0;f<e;f++)d.push(b.call(c,a[f]))}return d};$jscomp.array.of=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];return $jscomp.array.from(b)};
$jscomp.array.entries=function(){return $jscomp.array.arrayIterator_(this,function(a,b){return[a,b]})};$jscomp.array.entries$install=function(){Array.prototype.entries||(Array.prototype.entries=$jscomp.array.entries)};$jscomp.array.keys=function(){return $jscomp.array.arrayIterator_(this,function(a){return a})};$jscomp.array.keys$install=function(){Array.prototype.keys||(Array.prototype.keys=$jscomp.array.keys)};$jscomp.array.values=function(){return $jscomp.array.arrayIterator_(this,function(a,b){return b})};
$jscomp.array.values$install=function(){Array.prototype.values||(Array.prototype.values=$jscomp.array.values)};$jscomp.array.copyWithin=function(a,b,c){var d=this.length;a=Number(a);b=Number(b);c=Number(null!=c?c:d);if(a<b)for(c=Math.min(c,d);b<c;)b in this?this[a++]=this[b++]:(delete this[a++],b++);else for(c=Math.min(c,d+b-a),a+=c-b;c>b;)--c in this?this[--a]=this[c]:delete this[a];return this};$jscomp.array.copyWithin$install=function(){Array.prototype.copyWithin||(Array.prototype.copyWithin=$jscomp.array.copyWithin)};
$jscomp.array.fill=function(a,b,c){null!=c&&a.length||(c=this.length||0);c=Number(c);for(b=Number((void 0===b?0:b)||0);b<c;b++)this[b]=a;return this};$jscomp.array.fill$install=function(){Array.prototype.fill||(Array.prototype.fill=$jscomp.array.fill)};$jscomp.array.find=function(a,b){return $jscomp.array.findInternal_(this,a,b).v};$jscomp.array.find$install=function(){Array.prototype.find||(Array.prototype.find=$jscomp.array.find)};
$jscomp.array.findIndex=function(a,b){return $jscomp.array.findInternal_(this,a,b).i};$jscomp.array.findIndex$install=function(){Array.prototype.findIndex||(Array.prototype.findIndex=$jscomp.array.findIndex)};$jscomp.Map=function(a){a=void 0===a?[]:a;this.data_={};this.head_=$jscomp.Map.createHead_();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b=a.next();!b.done;b=a.next())b=b.value,this.set(b[0],b[1])}};
$jscomp.Map.checkBrowserConformance_=function(){var a=$jscomp.global.Map;if(!a||!a.prototype.entries||!Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a($jscomp.makeIterator([[b,"s"]]));if("s"!=c.get(b)||1!=c.size||c.get({x:4})||c.set({x:4},"t")!=c||2!=c.size)return!1;var d=c.entries(),e=d.next();if(e.done||e.value[0]!=b||"s"!=e.value[1])return!1;e=d.next();return e.done||4!=e.value[0].x||"t"!=e.value[1]||!d.next().done?!1:!0}catch(f){return!1}};
$jscomp.Map.createHead_=function(){var a={};return a.previous=a.next=a.head=a};$jscomp.Map.getId_=function(a){if(!(a instanceof Object))return String(a);$jscomp.Map.key_ in a||a instanceof Object&&Object.isExtensible&&Object.isExtensible(a)&&$jscomp.Map.defineProperty_(a,$jscomp.Map.key_,++$jscomp.Map.index_);return $jscomp.Map.key_ in a?a[$jscomp.Map.key_]:" "+a};
$jscomp.Map.prototype.set=function(a,b){var c=this.maybeGetEntry_(a),d=c.id,e=c.list,c=c.entry;e||(e=this.data_[d]=[]);c?c.value=b:(c={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,value:b},e.push(c),this.head_.previous.next=c,this.head_.previous=c,this.size++);return this};
$jscomp.Map.prototype["delete"]=function(a){var b=this.maybeGetEntry_(a);a=b.id;var c=b.list,d=b.index;return(b=b.entry)&&c?(c.splice(d,1),c.length||delete this.data_[a],b.previous.next=b.next,b.next.previous=b.previous,b.head=null,this.size--,!0):!1};$jscomp.Map.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=$jscomp.Map.createHead_();this.size=0};$jscomp.Map.prototype.has=function(a){return!!this.maybeGetEntry_(a).entry};
$jscomp.Map.prototype.get=function(a){return(a=this.maybeGetEntry_(a).entry)&&a.value};$jscomp.Map.prototype.maybeGetEntry_=function(a){var b=$jscomp.Map.getId_(a),c=this.data_[b];if(c)for(var d=0;d<c.length;d++){var e=c[d];if(a!==a&&e.key!==e.key||a===e.key)return{id:b,list:c,index:d,entry:e}}return{id:b,list:c,index:-1,entry:void 0}};$jscomp.Map.prototype.entries=function(){return this.iter_(function(a){return[a.key,a.value]})};$jscomp.Map.prototype.keys=function(){return this.iter_(function(a){return a.key})};
$jscomp.Map.prototype.values=function(){return this.iter_(function(a){return a.value})};$jscomp.Map.prototype.forEach=function(a,b){for(var c=$jscomp.makeIterator(this.entries()),d=c.next();!d.done;d=c.next())d=d.value,a.call(b,d[1],d[0],this)};
$jscomp.Map.prototype.iter_=function(a){var b=this,c=this.head_;$jscomp.initSymbol();$jscomp.initSymbolIterator();var d={};return d.next=function(){if(c){for(;c.head!=b.head_;)c=c.previous;for(;c.next!=c.head;)return c=c.next,{done:!1,value:a(c)};c=null}return{done:!0,value:void 0}},d[Symbol.iterator]=function(){return this},d};$jscomp.Map.index_=0;$jscomp.Map.defineProperty_=Object.defineProperty?function(a,b,c){Object.defineProperty(a,b,{value:String(c)})}:function(a,b,c){a[b]=String(c)};
$jscomp.Map.Entry_=function(){};$jscomp.Map.ASSUME_NO_NATIVE=!1;$jscomp.Map$install=function(){$jscomp.initSymbol();$jscomp.initSymbolIterator();!$jscomp.Map.ASSUME_NO_NATIVE&&$jscomp.Map.checkBrowserConformance_()?$jscomp.Map=$jscomp.global.Map:($jscomp.initSymbol(),$jscomp.initSymbolIterator(),$jscomp.Map.prototype[Symbol.iterator]=$jscomp.Map.prototype.entries,$jscomp.initSymbol(),$jscomp.Map.key_=Symbol("map-id-key"));$jscomp.Map$install=function(){}};$jscomp.math=$jscomp.math||{};
$jscomp.math.clz32=function(a){a=Number(a)>>>0;if(0===a)return 32;var b=0;0===(a&4294901760)&&(a<<=16,b+=16);0===(a&4278190080)&&(a<<=8,b+=8);0===(a&4026531840)&&(a<<=4,b+=4);0===(a&3221225472)&&(a<<=2,b+=2);0===(a&2147483648)&&b++;return b};$jscomp.math.imul=function(a,b){a=Number(a);b=Number(b);var c=a&65535,d=b&65535;return c*d+((a>>>16&65535)*d+c*(b>>>16&65535)<<16>>>0)|0};$jscomp.math.sign=function(a){a=Number(a);return 0===a||isNaN(a)?a:0<a?1:-1};
$jscomp.math.log10=function(a){return Math.log(a)/Math.LN10};$jscomp.math.log2=function(a){return Math.log(a)/Math.LN2};$jscomp.math.log1p=function(a){a=Number(a);if(.25>a&&-.25<a){for(var b=a,c=1,d=a,e=0,f=1;e!=d;)b*=a,f*=-1,d=(e=d)+f*b/++c;return d}return Math.log(1+a)};$jscomp.math.expm1=function(a){a=Number(a);if(.25>a&&-.25<a){for(var b=a,c=1,d=a,e=0;e!=d;)b*=a/++c,d=(e=d)+b;return d}return Math.exp(a)-1};$jscomp.math.cosh=function(a){a=Number(a);return(Math.exp(a)+Math.exp(-a))/2};
$jscomp.math.sinh=function(a){a=Number(a);return 0===a?a:(Math.exp(a)-Math.exp(-a))/2};$jscomp.math.tanh=function(a){a=Number(a);if(0===a)return a;var b=Math.exp(2*-Math.abs(a)),b=(1-b)/(1+b);return 0>a?-b:b};$jscomp.math.acosh=function(a){a=Number(a);return Math.log(a+Math.sqrt(a*a-1))};$jscomp.math.asinh=function(a){a=Number(a);if(0===a)return a;var b=Math.log(Math.abs(a)+Math.sqrt(a*a+1));return 0>a?-b:b};
$jscomp.math.atanh=function(a){a=Number(a);return($jscomp.math.log1p(a)-$jscomp.math.log1p(-a))/2};
$jscomp.math.hypot=function(a,b,c){for(var d=[],e=2;e<arguments.length;++e)d[e-2]=arguments[e];a=Number(a);b=Number(b);for(var f=Math.max(Math.abs(a),Math.abs(b)),g=$jscomp.makeIterator(d),e=g.next();!e.done;e=g.next())f=Math.max(f,Math.abs(e.value));if(1E100<f||1E-100>f){a/=f;b/=f;g=a*a+b*b;d=$jscomp.makeIterator(d);for(e=d.next();!e.done;e=d.next())e=e.value,e=Number(e)/f,g+=e*e;return Math.sqrt(g)*f}f=a*a+b*b;d=$jscomp.makeIterator(d);for(e=d.next();!e.done;e=d.next())e=e.value,f+=e*e;return Math.sqrt(f)};
$jscomp.math.trunc=function(a){a=Number(a);if(isNaN(a)||Infinity===a||-Infinity===a||0===a)return a;var b=Math.floor(Math.abs(a));return 0>a?-b:b};$jscomp.math.cbrt=function(a){if(0===a)return a;a=Number(a);var b=Math.pow(Math.abs(a),1/3);return 0>a?-b:b};$jscomp.number=$jscomp.number||{};$jscomp.number.isFinite=function(a){return"number"!==typeof a?!1:!isNaN(a)&&Infinity!==a&&-Infinity!==a};$jscomp.number.isInteger=function(a){return $jscomp.number.isFinite(a)?a===Math.floor(a):!1};
$jscomp.number.isNaN=function(a){return"number"===typeof a&&isNaN(a)};$jscomp.number.isSafeInteger=function(a){return $jscomp.number.isInteger(a)&&Math.abs(a)<=$jscomp.number.MAX_SAFE_INTEGER};$jscomp.number.EPSILON=Math.pow(2,-52);$jscomp.number.MAX_SAFE_INTEGER=9007199254740991;$jscomp.number.MIN_SAFE_INTEGER=-9007199254740991;$jscomp.object=$jscomp.object||{};
$jscomp.object.assign=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];c=$jscomp.makeIterator(c);for(d=c.next();!d.done;d=c.next()){var d=d.value,e;for(e in d)Object.prototype.hasOwnProperty.call(d,e)&&(a[e]=d[e])}return a};$jscomp.object.is=function(a,b){return a===b?0!==a||1/a===1/b:a!==a&&b!==b};$jscomp.Set=function(a){a=void 0===a?[]:a;this.map_=new $jscomp.Map;if(a){a=$jscomp.makeIterator(a);for(var b=a.next();!b.done;b=a.next())this.add(b.value)}this.size=this.map_.size};
$jscomp.Set.checkBrowserConformance_=function(){var a=$jscomp.global.Set;if(!a||!a.prototype.entries||!Object.seal)return!1;var b=Object.seal({x:4}),a=new a($jscomp.makeIterator([b]));if(a.has(b)||1!=a.size||a.add(b)!=a||1!=a.size||a.add({x:4})!=a||2!=a.size)return!1;var a=a.entries(),c=a.next();if(c.done||c.value[0]!=b||c.value[1]!=b)return!1;c=a.next();return c.done||c.value[0]==b||4!=c.value[0].x||c.value[1]!=c.value[0]?!1:a.next().done};
$jscomp.Set.prototype.add=function(a){this.map_.set(a,a);this.size=this.map_.size;return this};$jscomp.Set.prototype["delete"]=function(a){a=this.map_["delete"](a);this.size=this.map_.size;return a};$jscomp.Set.prototype.clear=function(){this.map_.clear();this.size=0};$jscomp.Set.prototype.has=function(a){return this.map_.has(a)};$jscomp.Set.prototype.entries=function(){return this.map_.entries()};$jscomp.Set.prototype.values=function(){return this.map_.values()};
$jscomp.Set.prototype.forEach=function(a,b){var c=this;this.map_.forEach(function(d){return a.call(b,d,d,c)})};$jscomp.Set.ASSUME_NO_NATIVE=!1;$jscomp.Set$install=function(){!$jscomp.Set.ASSUME_NO_NATIVE&&$jscomp.Set.checkBrowserConformance_()?$jscomp.Set=$jscomp.global.Set:($jscomp.Map$install(),$jscomp.initSymbol(),$jscomp.initSymbolIterator(),$jscomp.Set.prototype[Symbol.iterator]=$jscomp.Set.prototype.values);$jscomp.Set$install=function(){}};$jscomp.string=$jscomp.string||{};
$jscomp.string.noRegExp_=function(a,b){if(a instanceof RegExp)throw new TypeError("First argument to String.prototype."+b+" must not be a regular expression");};
$jscomp.string.fromCodePoint=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];for(var c="",b=$jscomp.makeIterator(b),d=b.next();!d.done;d=b.next()){d=d.value;d=+d;if(0>d||1114111<d||d!==Math.floor(d))throw new RangeError("invalid_code_point "+d);65535>=d?c+=String.fromCharCode(d):(d-=65536,c+=String.fromCharCode(d>>>10&1023|55296),c+=String.fromCharCode(d&1023|56320))}return c};
$jscomp.string.repeat=function(a){var b=this.toString();if(0>a||1342177279<a)throw new RangeError("Invalid count value");a|=0;for(var c="";a;)if(a&1&&(c+=b),a>>>=1)b+=b;return c};$jscomp.string.repeat$install=function(){String.prototype.repeat||(String.prototype.repeat=$jscomp.string.repeat)};
$jscomp.string.codePointAt=function(a){var b=this.toString(),c=b.length;a=Number(a)||0;if(0<=a&&a<c){a|=0;var d=b.charCodeAt(a);if(55296>d||56319<d||a+1===c)return d;a=b.charCodeAt(a+1);return 56320>a||57343<a?d:1024*(d-55296)+a+9216}};$jscomp.string.codePointAt$install=function(){String.prototype.codePointAt||(String.prototype.codePointAt=$jscomp.string.codePointAt)};
$jscomp.string.includes=function(a,b){b=void 0===b?0:b;$jscomp.string.noRegExp_(a,"includes");return-1!==this.toString().indexOf(a,b)};$jscomp.string.includes$install=function(){String.prototype.includes||(String.prototype.includes=$jscomp.string.includes)};
$jscomp.string.startsWith=function(a,b){b=void 0===b?0:b;$jscomp.string.noRegExp_(a,"startsWith");var c=this.toString();a+="";for(var d=c.length,e=a.length,f=Math.max(0,Math.min(b|0,c.length)),g=0;g<e&&f<d;)if(c[f++]!=a[g++])return!1;return g>=e};$jscomp.string.startsWith$install=function(){String.prototype.startsWith||(String.prototype.startsWith=$jscomp.string.startsWith)};
$jscomp.string.endsWith=function(a,b){$jscomp.string.noRegExp_(a,"endsWith");var c=this.toString();a+="";void 0===b&&(b=c.length);for(var d=Math.max(0,Math.min(b|0,c.length)),e=a.length;0<e&&0<d;)if(c[--d]!=a[--e])return!1;return 0>=e};$jscomp.string.endsWith$install=function(){String.prototype.endsWith||(String.prototype.endsWith=$jscomp.string.endsWith)};
function Api(a){var b=this;this.url=a;this.request=function(a,b){var e={method:a,path:this.url+b,headers:{},query:{},then_handler:function(a){return console.log(a)},catch_handler:function(a){return console.log(a)},payload:null,match:function(a){var b=this;Object.keys(a).forEach(function(c){return b.eq(c,a[c])});return this},select:function(a){this.query.select=a.replace(/\s/g,"");return this},order:function(a,b,c){this.query.order=a+"."+(b?"asc":"desc")+"."+(c?"nullsfirst":"nullslast");return this},
range:function(a,b){this.headers["Range-Unit"]="items";this.headers.Range=(a||"0")+"-"+(b||"");return this},single:function(){this.headers.Prefer="plurality=singular";return this},representation:function(){this.headers.Prefer="return=representation";return this},body:function(a){this.payload=a;return this},send:function(){var a=this;if(void 0!==this.xhr)return this;this.path+="?";for(var b in this.query)this.path+=b+"="+encodeURIComponent(this.query[b])+"&";this.xhr=new XMLHttpRequest;this.xhr.open(this.method,
this.path,!0);for(var c in this.headers)this.xhr.setRequestHeader(c,this.headers[c]);this.xhr.onreadystatechange=function(){if(4===a.xhr.readyState)if(200<=a.xhr.status&&300>a.xhr.status){var b;a:{try{b=JSON.parse(a.xhr.responseText);break a}catch(c){}b=void 0}b=b||{};var d=a.xhr.getResponseHeader("Content-Range"),e=/^(\d+)-(\d+)\/(\d+)$/;Array.isArray(b)&&d&&e.test(d)&&(d=e.exec(d),b.from=parseInt(d[1],10),b.to=parseInt(d[2],10),b.fullLength=parseInt(d[3],10));a.then_handler(b)}else{b=a.xhr.responseText;
try{b=JSON.parse(b).message}catch(c){}a.catch_handler(b)}};if(null!==this.payload){var d=function(a){return Array.isArray(a)?"{"+a.map(d).join(",")+"}":JSON.stringify(a)};this.xhr.setRequestHeader("Content-Type","application/json");for(var e in this.payload)Array.isArray(this.payload[e])&&(this.payload[e]=d(this.payload[e]));this.xhr.send(JSON.stringify(this.payload))}else this.xhr.send();return this},then:function(a){this.then_handler=a;return this.send()},catch:function(a){this.catch_handler=a;
return this.send()}};e.headers.Accept="application/json";e.headers.Prefer=b.startsWith("/rpc/")?"count=none":"";e.headers.Authorization=localStorage.id_token?"Bearer "+localStorage.id_token:"";"eq gt lt gte lte like ilike is in not".split(" ").map(function(a){return e[a]=function(b,c){e.query[b]=a+"."+(Array.isArray(c)?c.join(","):c);return e}});return e};["POST","GET","PATCH","DELETE","OPTIONS"].map(function(a){return b[a.toLowerCase()]=function(d){return b.request(a,d)}})}var api=new Api("/api/");(function(){var a=null,b=function(b,d){if(null!==a)b(a);else{var e=document.createElement("script");e.type="text/javascript";e.src="//cdn.auth0.com/js/lock-8.2.min.js";e.onload=e.onreadystatechange=function(d,e,h,k){a=new Auth0Lock("AZmtkBN5zDGERJesFZGFS8vYJYyZTrDo","openeth.auth0.com");b(a)};document.getElementsByTagName("body")[0].appendChild(e)}};window.addEventListener("DOMContentLoaded",function(){var a=document.getElementById("btn-login");a instanceof HTMLButtonElement&&(a.disabled=!1,a.addEventListener("click",
function(){b(function(a){var b={icon:"buddha.png",authParams:{}};b.authParams.scope="openid role userid";a.show(b)})}));a=document.getElementById("btn-logout");a instanceof HTMLButtonElement&&(a.disabled=!0,a.addEventListener("click",function(){localStorage.removeItem("id_token");window.location.href="/"}))});-1==window.location.hash.indexOf("id_token=")&&-1==window.location.hash.indexOf("error=")||b(function(a){if(a=a.parseHash(window.location.hash))a.error?console.log("There was an error logging in",
a.error):(localStorage.setItem("id_token",a.id_token),window.location.hash="",history.replaceState("",document.title,window.location.pathname+window.location.search))})})();RegExp.escape=function(a){return String(a).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1")};Array.prototype.clone=function(a){return this.slice(0)};Array.prototype.remove=function(a){return this.splice(a,1)[0]};Array.prototype.insert=function(a,b){this.splice(a,0,b)};Array.prototype.swap=function(a,b){var c=this[a];this[a]=this[b];this[b]=c;return this};Array.prototype.repeat=function(a){for(var b=[],c=0;c<a;++c)b.push(this);return Function.prototype.call.apply(Array.prototype.concat,b)};
Array.range=function(a,b,c){var d=void 0===b?a:b;c=void 0===c?1:c;var e=[];for(a=void 0===b?0:a;a<d;a+=c)e.push(a);return e};Array.prototype.permutations=function(){return this.reduce(function b(c,d,e,f){return c.concat(1<f.length&&f.slice(0,e).concat(f.slice(e+1)).reduce(b,[]).map(function(b){return[d].concat(b)})||d)},[])};Array.prototype.equals=function(a,b){void 0===b&&(b=function(a,b){return a===b});return this.length===a.length&&this.every(function(c,d){return b(c,a[d])})};
Array.prototype.unique=function(a){void 0===a&&(a=function(a,c){return a===c});return this.filter(function(b,c,d){return c==d.findIndex(function(c){return a(b,c)})})};Array.prototype.join=function(a,b){if(0!=this.length){if(1==this.length)return this[0];for(var c=void 0!==this[0]?this[0]:"",d=1;d<this.length;++d)void 0!==a&&(d<this.length-1?c+=a:d===this.length-1&&(c=void 0!==b?c+b:c+a)),void 0!==this[d]&&(c+=this[d]);return c}};
Array.prototype.equals=function(a){return this.every(function(b,c){return b==a[c]})};Array.prototype.reorder=function(a,b){this.insert(b,this.remove(a))};var HTMLEscapeElement=document.createElement("div");function HTMLEscape(a){HTMLEscapeElement.textContent=a;return HTMLEscapeElement.innerHTML}function HTMLUnescape(a){HTMLEscapeElement.innerHTML=a;return HTMLEscapeElement.textContent}$jscomp.initSymbol();$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();
NodeList.prototype[Symbol.iterator]=Array.prototype[Symbol.iterator];$jscomp.initSymbol();$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();HTMLCollection.prototype[Symbol.iterator]=Array.prototype[Symbol.iterator];function make_unique(a,b){if(!a.includes(b))return b;b=b.replace(/ \(\d+\)$/,"");for(var c=0,d=new RegExp("^"+RegExp.escape(b)+" \\((\\d+)\\)$"),e=$jscomp.makeIterator(a),f=e.next();!f.done;f=e.next())f=f.value.match(d),null!==f&&(c=Math.max(c,f[1]));b=b+" ("+(c+1)+")";console.log("Renamed to <em>"+HTMLEscape(b)+"</em>.");return b}
var main=document.getElementById("main"),actions=document.getElementById("actions"),cases=document.getElementById("cases"),features=document.getElementById("features"),guidance=document.getElementById("guidance"),duties=document.getElementById("duties"),principles=document.getElementById("principles");main.form=document.getElementById("edit_dilemma");main.edit=function(){var a=extract(main);join(main.form,a);show_modal(main.form,function(){var a=extract(main.form);join(main,a)})};actions.form=document.getElementById("edit_action");
actions.name=function(a){return extract(actions).actions[a]};actions.index=function(a){return extract(actions).actions.indexOf(a)};
actions.edit=function(a){var b=extract(a),c=actions.index(b),d=extract(actions).actions.slice();d.splice(c,1);join(actions.form,b);show_modal(actions.form,function(){var c=extract(actions.form),c=c.trim();if(""===c)console.log("Action name can not be empty.",4E3);else if(c!==b){c=make_unique(d,c);join(a,c);for(var f=$jscomp.makeIterator(cases.querySelectorAll(".action")),g=f.next();!g.done;g=f.next())g=g.value,g.textContent===b&&(g.textContent=c);principles.update()}})};
actions.reorder=function(a,b){--a;--b;for(var c=$jscomp.makeIterator(cases.getElementsByTagName("case")),d=c.next();!d.done;d=c.next())if(d=d.value,!d.hasAttribute("hidden")){var d=d.getElementsByTagName("div")[0],e=extract(d);e.features.reorder(a,b);join(d,e)}principles.update()};features.form=document.getElementById("edit_feature");features.name=function(a){return extract(features).features[a]};features.index=function(a){return extract(features).features.indexOf(a)};
features.edit=function(a){var b=extract(a),c=features.index(b),d=extract(features).features.slice();d.splice(c,1);join(features.form,extract(a));show_modal(features.form,function(c){if("remove"===c)return features.remove(a);c=extract(features.form);c=c.trim();""===c?Materialize.toast("Feature name can not be empty.",4E3):c!==b&&(c=make_unique(d,c),join(a,c),principles.update())})};
features.add=function(){var a=extract(features).features;join(features.form,"");show_modal(features.form,function(b){b=extract(features.form);b=b.trim();if(""===b)Materialize.toast("Feature name can not be empty.",4E3);else{b=make_unique(a,b);var c=features.children[0].cloneNode(!0);c.removeAttribute("hidden");join(c,b);features.appendChild(c);b=$jscomp.makeIterator(cases.getElementsByTagName("case"));for(c=b.next();!c.done;c=b.next())if(c=c.value,!c.hasAttribute("hidden")){var c=c.getElementsByTagName("div")[0],
d=extract(c);d.features.forEach(function(a){a.insert(index,null)});join(c,d)}principles.update()}})};features.remove=function(a){var b=Array.prototype.indexOf.call(a.parentNode.children,a)-1;a.parentNode.removeChild(a);a=$jscomp.makeIterator(cases.getElementsByTagName("case"));for(var c=a.next();!c.done;c=a.next())if(c=c.value,!c.hasAttribute("hidden")){var c=c.getElementsByTagName("div")[0],d=extract(c);d.features.forEach(function(a){a.remove(b)});join(c,d)}principles.update()};
features.reorder=function(a,b){--a;--b;for(var c=$jscomp.makeIterator(cases.getElementsByTagName("case")),d=c.next();!d.done;d=c.next())if(d=d.value,!d.hasAttribute("hidden")){var d=d.getElementsByTagName("div")[0],e=extract(d);e.features.forEach(function(c){c.reorder(a,b)});join(d,e)}principles.update()};cases.form=document.getElementById("edit_case");
cases.edit=function(a){var b=extract(a);join(cases.form,b);show_fullscreen(cases.form,function(b){if("remove"===b)return cases.remove(a);b=extract(cases.form);join(a,b);principles.update()})};
cases.add=function(){var a=extract(cases).cases.map(function(a){return a.name}),b=extract(actions).actions,c=extract(features).features;join(cases.form,{id:null,name:"New Case",description:"",action:void 0,features:[[null].repeat(c.length)].repeat(b.length)});show_fullscreen(cases.form,function(b){b=extract(cases.form);console.log(b);b.name=b.name.trim();""===b.name&&(b.name="New Case");b.name=make_unique(a,b.name);var c=cases.children[0].cloneNode(!0);c.removeAttribute("hidden");join(c,b);cases.appendChild(c);
principles.update()})};cases.remove=function(a){a.parentNode.removeChild(a);principles.update()};
cases.join_features=function(a){var b=extract(actions).actions,c=extract(features).features,d=document.getElementById("case_features");rescale_array(d,b.length);for(var e=0;e<b.length;++e){var f=d.children[e+1],g=f.getElementsByTagName("legend")[0],f=f.getElementsByTagName("div")[0];g.textContent=b[e];rescale_array(f,c.length);for(g=0;g<c.length;++g){var h=f.children[g+1],k=a.features[e][g],n=h.children[0],m=h.children[2],l=h.children[3];h.children[1].textContent=c[g];null===k?(n.checked=!1,l.value=
0,l.disabled=!0,m.textContent=""):(n.checked=!0,l.value=k,l.disabled=!1,m.textContent=k)}}};cases.extract_features=function(){for(var a=document.getElementById("case_features"),b=[],c=1;c<a.children.length;++c){for(var d=[],e=a.children[c].getElementsByTagName("div")[0],f=1;f<e.children.length;++f){var g=e.children[f],h=g.children[3];g.children[0].checked?d.push(parseInt(h.value)):d.push(null)}b.push(d)}return{features:b}};
cases.change_checkbox=function(a){a=a.parentNode;var b=a.children[2],c=a.children[3];a.children[0].checked?(b.textContent=c.value,c.disabled=!1):(b.textContent="",c.disabled=!0);cases.update_table(extract(cases.form))};cases.change_range=function(a){a=a.parentNode;a.children[2].textContent=a.children[3].value;cases.update_table(extract(cases.form))};
function flesh_out(a){var b=a.length;if(0===b)return a;var c=a[0].length;if(0===c)return a;for(var d=0;d<b;++d)for(var e=0;e<c;++e)null===a[d][e]&&(a[d][e]=-a[b-d-1][e]),null===a[d][e]&&(a[d][e]=0);return a}
cases.update_table=function(a){a=flesh_out(a.features);document.getElementById("case_features");for(var b=document.getElementById("cases_table"),c=b.getElementsByTagName("thead")[0],b=b.getElementsByTagName("tbody")[0],d=extract(actions).actions,e=extract(features).features;c.hasChildNodes();)c.removeChild(c.lastChild);for(;b.hasChildNodes();)b.removeChild(b.lastChild);var f=document.createElement("tr");f.appendChild(document.createElement("td"));for(var g=$jscomp.makeIterator(e),h=g.next();!h.done;h=
g.next()){var h=h.value,k=document.createElement("th");k.textContent=h;f.appendChild(k)}c.appendChild(f);c=0;d=$jscomp.makeIterator(d);for(h=d.next();!h.done;h=d.next()){h=h.value;f=document.createElement("tr");g=document.createElement("th");g.textContent=h;f.appendChild(g);g=0;k=$jscomp.makeIterator(e);for(h=k.next();!h.done;h=k.next())h=document.createElement("td"),h.textContent=a[c][g],f.appendChild(h),++g;b.appendChild(f);++c}};
Array.prototype.greaterOrEqualThan=function(a){return this.every(function(b,c){return b>=a[c]})};Array.prototype.zip=function(a){for(var b=[],c=0;c<this.length;++c)b.push([this[c],a[c]]);return b};
function findSigns(a,b){for(var c=a[0].length,d=[],e={},f=0;f<Math.pow(2,c);e={sign:e.sign,neg:e.neg},++f){e.sign=[];for(var g=0;g<c;++g)e.sign.push(0!=(f&1<<g)?-1:1);g=a.map(function(a){return a.map(function(a){return function(b,c){return b*a.sign[c]}}(e))});e.neg=b.map(function(a){return a.map(function(a){return function(b,c){return b*a.sign[c]}}(e))});g.every(function(a){return function(b){return a.neg.every(function(a){return a.some(function(a,c){return a<b[c]})})}}(e))&&d.push(e.sign)}0==d.length&&
console.log("Inconsistent signs!");f=d[0];d=$jscomp.makeIterator(d);for(g=d.next();!g.done;g=d.next())for(var g=g.value,h=0;h<c;++h)f[h]!==g[h]&&(f[h]=0);return f}
function maximizeVolume(a,b){if(b.every(function(b){return b.some(function(b,c){return b<a[c]})})){var c=Array.range(a.length).permutations().map(function(c){return c.reduce(function(a,c){var d=Math.max.apply(null,b.filter(function(b){return b.every(function(b,d){return d===c||b>=a[d]})}).map(function(a){return 1+a[c]}));d>a[c]&&console.log("Illegal bound in maximizeVolume");a[c]=d;return a},a.clone())}).filter(function(a,b,c){return b==c.findIndex(function(b){return b.every(function(b,c){return b==
a[c]})})}),d=Math.min.apply(null,c.map(function(a){return a.length-a.filter(function(a){return-Infinity===a}).length}));return c=c.filter(function(a){return a.length-a.filter(function(a){return-Infinity===a}).length==d})}console.log("Inconsistent clause!")}
principles.update=function(){function a(b){if(0===b.length)return[[]];var c=b[0];b=a(b.slice(1));for(var d=[],c=$jscomp.makeIterator(c),e=c.next();!e.done;e=c.next())for(var e=e.value,f=$jscomp.makeIterator(b),g=f.next();!g.done;g=f.next())d.push([e].concat(g.value));return d}extract(actions);for(var b=extract(features).features,c=b.length,d=[],e=[],f=extract(cases),f=$jscomp.makeIterator(f.cases),g=f.next();!g.done;g=f.next()){for(var h=g.value,g=flesh_out(h.features),k=h.action,h=1-h.action,n=[],
m=0;m<c;++m)n[m]=g[k][m]-g[h][m];d.push(n);e.push(n.map(function(a){return-a}))}var l=findSigns(d,e);duties.innerHTML="<ul><li>It can be inferred that there are (prima facie) duties to <ul>"+l.map(function(a,c){return 0===a?void 0:(0>a?"minimize ":"maximize ")+b[c]}).filter(function(a){return void 0!==a}).map(function(a){return"<li>"+a+"</li>"}).join()+"</ul></li></ul>";guidance.innerHTML=l.map(function(a,c){return 0!==a?"":"<p>Could not determine if "+b[c]+" is a good or a bad thing.</p>"}).join();
var d=d.map(function(a){return a.map(function(a,b){return a*l[b]})}),e=e.map(function(a){return a.map(function(a,b){return a*l[b]})}),c=d.map(function(a){return maximizeVolume(a,e)}),d=a(c),d=d.map(function(a){return a.unique(function(a,b){return a.equals(b)})}),p=Math.min.apply(null,d.map(function(a){return a.length})),d=d.filter(function(a){return a.length===p});1<d.length&&console.log("Still some ambiguity remaining.");c="<ul>";d=$jscomp.makeIterator(d[0]);for(f=d.next();!f.done;f=d.next()){g=
f.value;c+="<li>An action is ethically preferable to another if it <ul>";f=0;g=$jscomp.makeIterator(g);for(k=g.next();!k.done;k=g.next())k=k.value,-Infinity!==k&&(c+="<li>",c=0<k?c+"satisfies the duty to ":c+"does not violate the duty to ",c=0>l[f]?c+"minimize ":c+"maximize ",c+=b[f],c+=" by a value ",c=0<k?c+"at least ":c+"greater than ",c+=Math.abs(k),c+=" more",c+="</li>"),++f;c+="</ul></li>"}principles.innerHTML=c};
function debug(){var a=extract("main"),b=document.getElementById("debug");join(b,a);show_modal(b)}function test(){var a=extract("main");join("main",a);var b=extract("main");console.log(a,b);JSON.stringify(a)!==JSON.stringify(b)&&console.log("Test failed")}function load(a){get(a,function(a){join("main",a);principles.update()})}window.addEventListener("DOMContentLoaded",function(){reset();api.get("dilemmas").select("id, name").order("id",!0).range(0,4).then(function(a){return join("examples",a)})});
function load(a){api.get("dilemmas").eq("id",a).select("*,cases{*}").single().then(function(a){join("main",a);principles.update()})}
function store(){var a=extract("main");a.id?(api.patch("dilemmas").eq("id",a.id).body({name:a.name,description:a.description,actions:a.actions,features:a.features}).send(),a.cases.forEach(function(b,c){b.id?api.patch("cases").eq("id",b.id).body({position:c,name:b.name,action:b.action,features:b.features}).send():api.post("cases").representation().select("id").body({dilemma:a.id,position:c,name:b.name,action:b.action,features:b.features}).then(function(a){return b.id=a.id})})):api.post("dilemmas").representation().select("id").body({name:a.name,
description:a.description,actions:a.actions,features:a.features}).then(function(b){console.log(b);a.id=b;a.cases.forEach(function(a,b){api.post("cases").eq("id",a.id).body({position:b,name:a.name,action:a.action,features:a.features}).then(function(b){return a.id=b})});console.log(a)})}function delete_(){var a=extract("main");a.id&&api.delete("dilemmas").eq("id",a.id).send();reset()}
function reset(){join("main",{id:null,name:"New Dilemma",description:"Please edit this dilemma.",actions:["Action A","Action B"],features:["Feature 1"],cases:[]})};window.data_onreorder_onmousedown=function(a,b){var c=a.parentNode,d=!1,e=a.getBoundingClientRect(),f=(b.clientX-e.left)/e.width,g=(b.clientY-e.top)/e.height,h=Array.prototype.indexOf.call(c.children,a),k=a.cloneNode(!0);k.className+=" data_onreorder_dragging";k.style.left=b.clientX-f*e.width+"px";k.style.top=b.clientY-g*e.height+"px";k.style.width=e.width+"px";k.style.height=e.height+"px";c.appendChild(k);var n=document.createElement("div"),m=document.createElement("div");a.className+=" data_onreorder_placeholder0";
n.className="data_onreorder_placeholder1";m.className="data_onreorder_placeholder2";n.appendChild(m);a.appendChild(n);c.className+=" wiggle";var l=function(b){d=!0;k.style.visibility="hidden";var h=document.elementFromPoint(b.clientX,b.clientY);for(k.style.visibility="visible";h&&h.parentNode!==c;)h=h.parentNode;if(h&&h!=a){var l=h.nextSibling;l===a?c.insertBefore(a,h):(c.insertBefore(h,a),l?c.insertBefore(a,l):c.appendChild(a));e=a.getBoundingClientRect();k.style.width=e.width+"px";k.style.height=
e.height+"px"}k.style.left=b.clientX-f*e.width+"px";k.style.top=b.clientY-g*e.height+"px"},p=function(b){a.className=a.className.replace(/\bdata_onreorder_placeholder0\b/,"");c.className=c.className.replace(/\bdata_onreorder_wiggle\b/,"");c.removeChild(k);a.removeChild(n);d||a.click(b);if(void 0!==c.dataset&&void 0!==c.dataset.onreorder)try{var e=eval(c.dataset.onreorder);if("function"===typeof e){var f=Array.prototype.indexOf.call(c.children,a);e(h,f)}}catch(g){console.log(g)}b.preventDefault();
b.stopPropagation()};document.addEventListener("mousemove",l,!0);document.addEventListener("mouseup",function r(a){p(a);document.removeEventListener("mousemove",l,!0);document.removeEventListener("mouseup",r,!0)},!0);b.preventDefault();b.stopPropagation()};window.addEventListener("DOMContentLoaded",function(){for(var a=$jscomp.makeIterator(document.querySelectorAll("[data-onreorder] >*")),b=a.next();!b.done;b=a.next())b.value.setAttribute("onmousedown","data_onreorder_onmousedown(this,event)")});function show_form(a,b,c,d){b.constructor==String&&(b=document.getElementById(b));var e=document.getElementsByTagName("body")[0],f=document.getElementById("modal_backdrop");null===f&&(f=document.createElement("div"),f.id="modal_backdrop",f.setAttribute("hidden",""),e.appendChild(f));a?b.className+=" fullscreen_dialog":(b.className+=" modal_dialog",f.removeAttribute("hidden"));b.removeAttribute("hidden");e.style.overflow="hidden";var g=function(a){b.reset();a.preventDefault();a.stopPropagation()},
h=function(a){27===a.keyCode&&(b.reset(),a.preventDefault(),a.stopPropagation())},k,n,m=function(l,m){var q=void 0;document.activeElement instanceof HTMLButtonElement&&"submit"===document.activeElement.type&&(q=document.activeElement.value);a?b.className=b.className.replace(/\bfullscreen_dialog\b/,""):(b.className=b.className.replace(/\bmodal_dialog\b/,""),f.setAttribute("hidden",""),f.removeEventListener("click",g,!0));b.setAttribute("hidden","");e.style.overflow="";document.removeEventListener("keydown",
h,!0);b.removeEventListener("reset",k,!0);b.removeEventListener("submit",n,!0);m.preventDefault();m.stopPropagation();l&&"function"===typeof c&&c(q);l||"function"!==typeof d||d()};k=m.bind(null,!1);n=m.bind(null,!0);a||f.addEventListener("click",g,!0);document.addEventListener("keydown",h,!0);b.addEventListener("reset",k,!0);b.addEventListener("submit",n,!0)}var show_modal=show_form.bind(null,!1),show_fullscreen=show_form.bind(null,!0);function rescale_array(a,b){for(var c=a.children[0],d=a.children.length;d<b+1;++d){var e=c.cloneNode(!0);e.removeAttribute("hidden");a.appendChild(e)}for(;a.children.length>b+1;)a.removeChild(a.children[a.children.length-1])}
function join(a,b){if(a.constructor===String)return join(document.getElementById(a),b);if(void 0!==a.dataset){if(void 0!==a.dataset.value){if(""===a.dataset.value)return a.value=b;if(a.dataset.value in b)return a.value=b[a.dataset.value]}if(void 0!==a.dataset.content){if(""===a.dataset.content)return a.textContent=b;if(a.dataset.content in b)return a.textContent=b[a.dataset.content]}if(void 0!==a.dataset.join)return eval("(function(data){"+a.dataset.join+"})").apply(a,[b]);if(void 0!==a.dataset.array){var c=
""===a.dataset.array?b:b[a.dataset.array];if(!(c instanceof Array))return;rescale_array(a,c.length);for(var d=0;d<c.length;++d)join(a.children[d+1],c[d]);return}}if(void 0!==a.join&&a.join!==Node.prototype.join)return a.join(b);c=$jscomp.makeIterator(a.children);for(d=c.next();!d.done;d=c.next())join(d.value,b)}
function extract(a){function b(a,b){"undefined"===b&&(b=void 0);"null"===b&&(b=null);if(""===a)return b;var c={};c[a]=b;return c}if(a.constructor==String)return extract(document.getElementById(a));if(void 0!==a.dataset){if(void 0!==a.dataset.value)return b(a.dataset.value,a.value);if(void 0!==a.dataset.content)return b(a.dataset.content,a.textContent);if(void 0!==a.dataset.extract)return eval("(function(){"+a.dataset.extract+"})").apply(a,[]);if(void 0!==a.dataset.array){for(var c=[],d=1;d<a.children.length;++d)c.push(extract(a.children[d]));
return b(a.dataset.array,c)}}if(a.extract&&a.extract!==Node.prototype.extract)return a.extract();c=void 0;a=$jscomp.makeIterator(a.children);for(d=a.next();!d.done;d=a.next())if(d=extract(d.value),void 0!==d){if(d instanceof Array||!(d instanceof Object))return d;void 0===c&&(c={});c=Object.assign(c,d)}return c}Node.prototype.join=function(a){join(this,a)};Node.prototype.extract=function(){return extract(this)};
